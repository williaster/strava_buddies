?do.call
gsub.rownames
plot.positional.avg
head(ubc6.pos.log2enrich)
library(fpc)
source("~/R/positional_functions.R")
centi.path  <- "/home/cwilliams/"
filt.ct=5
filt.chx.enrich.forconsideration=0.5
filt.ntlen=0
flag.deltarank=-200
flag.nochxenrich=1
flag.enrichwindowceiling=0.5
alpha  <- 0.8
cols   <- brewer.pal(12, 'Paired')[c(8,10,2,4,6)] # c('#56B4E9','#FC8D59')
smooth.window <- 12
pseudo.ct     <- 1
aa.start<- 100
aa.stop <- 500
pseudo.ct <- 0.00000000001
# Annotation files
f.kin         <- paste0(centi.path, 'data/ER_yeast/2012-Dec/yCW51_kinetics/kin.dput')
f.maya.scores    <- paste0(centi.path, "genomes/sacCer3/geneLists/srp/scores_mmc1.csv")
f.maya.srp.indpt <- paste0(centi.path, "genomes/sacCer3/geneLists/srp/SRPindpt_mmc2.csv")    #Low score, no downstream hydrophobic
f.maya.srp.dpt   <- paste0(centi.path, "genomes/sacCer3/geneLists/srp/SRPdept_119_mmc3.csv") #Sec72 indpt
f.phobius.parsed <- paste0(centi.path, "genomes/sacCer3/phobius/parsed_phobius")
f.hydrophobic.class <- paste0(centi.path, "genomes/sacCer3/phobius/hydrophobic_classes.table")
# Annotation structures
kin     <- dget(file=f.kin)
df.maya.scores   <- read.csv(f.maya.scores,header=TRUE,skip=2,as.is=TRUE)
df.maya.srpindpt <- read.csv(f.maya.srp.indpt,header=TRUE,skip=2,as.is=TRUE)
df.maya.srpdpt   <- read.csv(f.maya.srp.dpt,header=TRUE,skip=2,as.is=TRUE)
df.phobius.parsed  <- read.table(f.phobius.parsed, header=TRUE,
colClasses=c("character", "character", "numeric", "numeric", "numeric"))
df.hydrophob.class <- read.table(f.hydrophobic.class, header=TRUE, sep="\t", as.is=TRUE,
colClasses=c("character", "factor"))
#Maya categories
maya.secretome         <- df.maya.scores$Systematic.Name
maya.srpindpt          <- df.maya.srpindpt$Systematic.Name
maya.srpindpt.verified <- subset(df.maya.srpindpt, Verified.SRP.independent == 'YES')$Systematic.Name
maya.srpindpt.sec72dpt <- subset(df.maya.srpindpt, Screened.for.dependence.on.Sec72 == 'YES')$Systematic.Name
maya.srpdpt            <- df.maya.srpdpt$Systematic.name
#TargetP
f.targetp.sigp.90 <- paste0(centi.path, 'genomes/sacCer3/targetp/TargetP_90_rel3_sigpgenes.targetp')
f.targetp.mito.90 <- paste0(centi.path, 'genomes/sacCer3/targetp/TargetP_90_rel3_mitogenes.targetp')
f.targetp.greedymito <- paste0(centi.path, 'genomes/sacCer3/targetp/TargetP_greedynofiltmito_mitogenes.targetp')
targetp.sigp.90  <- read.table(file=f.targetp.sigp.90, as.is=TRUE)$V1
targetp.mito.90  <- read.table(file=f.targetp.mito.90, as.is=TRUE)$V1
targetp.greedymito<-read.table(file=f.targetp.greedymito, as.is=TRUE)$V1
#TMHMM/sigp
tmhmm    <- subset(kin, TMDs>0 & tail_anchor==0)$Genes
sigp     <- subset(kin, sigp==1)$Genes
gfp.er   <- unique(subset(unpack.listfactors(kin, 'loc', 'local'), local == 'ER')$Genes)
gfp.mito <- unique(subset(unpack.listfactors(kin, 'loc', 'local'), local == 'mitochondrion')$Genes)
go.mito  <- unique(subset(unpack.listfactors(kin, 'GO_comp', 'GOC'), GOC == 'mitochondrion' | GOC == 'mitochondrial envelope')$Genes)
#Define SRP dependence by ss length
SS.lengthcutoff <- 15
# Plot the histogram showing the cutoff used
#SS.lengthhist <-
#    ggplot(df.maya.scores,
#           aes(x=Length.of.hydrophobic.segment, fill=Class)) +
#    stat_bin(aes(y=..count..), binwidth=0.5) +
#    geom_vline(xint=SS.lengthcutoff+1) +
#    scale_fill_manual(values=cols)
#SS.lengthhist
lvls.srpdependence   <- c(paste0("SS (1-", SS.lengthcutoff,")"),
paste0("SS (>", SS.lengthcutoff,")"),
"No SS")
bins.srpdependence   <- findInterval(df.maya.scores$Length.of.hydrophobic.segment, c(0,SS.lengthcutoff+1))
bins.srpdependence   <- replace(bins.srpdependence, is.na(bins.srpdependence), 3) # Convert NAs to number
labels.srpdependence <- factor(bins.srpdependence, labels=lvls.srpdependence)
srpdpt       <- subset(cbind(df.maya.scores,
SS.cat=labels.srpdependence),
SS.cat == lvls.srpdependence[2])$Systematic.Name
srpindpt     <- subset(cbind(df.maya.scores,
SS.cat=labels.srpdependence),
SS.cat == lvls.srpdependence[1])$Systematic.Name
unclassified <- subset(cbind(df.maya.scores,
SS.cat=labels.srpdependence),
SS.cat == lvls.srpdependence[3])$Systematic.Name
# Add category to kin data.frame
kin$SRP.dependence <- as.factor( ifelse(kin$Genes %in% srpdpt,
"a. SRP Dependent",
ifelse(kin$Genes %in% srpindpt,
"b. SRP Independent",
ifelse(kin$Genes %in% unclassified,
"c. No N-term SS/TMD",
"d. Non-secretory"))) )
# dput objects with rank data
f.df.ranks           <- paste0(centi.path, "data/ER_yeast/yCW51_chx-nochx_df_ranks")
f.df.ranks.sepenrich <- paste0(centi.path, "data/ER_yeast/yCW51_chx-nochx_sepenrich_df_ranks")
# Positional data
# Sec63-mV-B
#5'
f.v.s63.1m <- "data/ER_yeast/2012-Dec/yCW51_kinetics/positional/500_orfonly/yCW51_nochx_1m_tev_NOlenfilt_5p_poscts_0to1500.txt"
f.t.s63.1m <- "data/ER_yeast/2012-Dec/yCW51_kinetics/positional/500_orfonly/yCW51_nochx_1m_total_NOlenfilt_5p_poscts_0to1500.txt"
f.v.s63.7mchx <- "data/ER_yeast/2012-Dec/yCW51_kinetics/positional/500_orfonly/yCW51_chx_7m_tev_NOlenfilt_5p_poscts_0to1500.txt"
f.t.s63.7mchx <- "data/ER_yeast/2012-Dec/yCW51_kinetics/positional/500_orfonly/yCW51_chx_7m_total_NOlenfilt_5p_poscts_0to1500.txt"
# 3'
f.3p.v.s63.1m <- "data/ER_yeast/2012-Dec/yCW51_kinetics/positional/500_orfonly/yCW51_nochx_1m_tev_NOlenfilt_3p_poscts_-1500to0.txt"
f.3p.t.s63.1m <- "data/ER_yeast/2012-Dec/yCW51_kinetics/positional/500_orfonly/yCW51_nochx_1m_total_NOlenfilt_3p_poscts_-1500to0.txt"
f.3p.v.s63.7mchx <- "data/ER_yeast/2012-Dec/yCW51_kinetics/positional/500_orfonly/yCW51_chx_7m_tev_NOlenfilt_3p_poscts_-1500to0.txt"
f.3p.t.s63.7mchx <- "data/ER_yeast/2012-Dec/yCW51_kinetics/positional/500_orfonly/yCW51_chx_7m_total_NOlenfilt_3p_poscts_-1500to0.txt"
# B-mV-Ssh1
#5'
f.v.ssh1.chx  <- "data/ER_yeast/2013-March/yCW156/yCW156_chx_tev_NOlenfilt_5p_poscts_0to1500.txt"
f.t.ssh1.chx  <- "data/ER_yeast/2013-March/yCW156/yCW156_chx_total_NOlenfilt_5p_poscts_0to1500.txt"
f.v.ssh1.nochx  <-"data/ER_yeast/2013-March/yCW156/yCW156_nochx_tev_NOlenfilt_5p_poscts_0to1500.txt"
f.t.ssh1.nochx  <- "data/ER_yeast/2013-March/yCW156/yCW156_nochx_total_NOlenfilt_5p_poscts_0to1500.txt"
# 3'
f.3p.v.ssh1.chx  <- "data/ER_yeast/2013-March/yCW156/yCW156_chx_tev_NOlenfilt_3p_poscts_-1500to0.txt"
f.3p.t.ssh1.chx  <- "data/ER_yeast/2013-March/yCW156/yCW156_chx_total_NOlenfilt_3p_poscts_-1500to0.txt"
f.3p.v.ssh1.nochx  <-"data/ER_yeast/2013-March/yCW156/yCW156_nochx_tev_NOlenfilt_3p_poscts_-1500to0.txt"
f.3p.t.ssh1.nochx  <- "data/ER_yeast/2013-March/yCW156/yCW156_nochx_total_NOlenfilt_3p_poscts_-1500to0.txt"
# UBC6/delta sec66/SRP-BirA files
f.v.ubc6   <- "data/ER_yeast/2013-May/positional/yCW150_chx_2m_tev_NOlenfilt_5p_poscts_0to1500.txt"
f.t.ubc6   <- "data/ER_yeast/2013-May/positional/yCW150_chx_2m_total_NOlenfilt_5p_poscts_0to1500.txt"
f.v.dsec66 <- "data/ER_yeast/2013-May/positional/yCW168_chx_2m_tev_NOlenfilt_5p_poscts_0to1500.txt"
f.t.dsec66 <- "data/ER_yeast/2013-May/positional/yCW168_chx_2m_total_NOlenfilt_5p_poscts_0to1500.txt"
f.v.srp    <- "data/ER_yeast/2013-May/positional/yCW194_chx_2m_tev_NOlenfilt_5p_poscts_0to1500.txt"
f.t.srp    <- "data/ER_yeast/2013-May/positional/yCW194_chx_2m_total_NOlenfilt_5p_poscts_0to1500.txt"
getwd()
require(caret)
require(plyr)
require(ggplot2)
35+133.71 +64+46.41+50+32.56
library(ggplot2)
setwd("~/Dropbox/insight-data-science/project/strava_buddies/R/")
f.validation  <- "validation.csv"
f.random.sim  <- "random_similarities.csv"
df.validation <- read.csv(f.validation)
df.random.sim <- read.csv(f.random.sim, header=FALSE, col.names=c("trial", "random_similarity"))
df.random.sim$n_activities <- sample(1:15, size=500, replace=TRUE)
p <-
ggplot(df.validation, aes(x=n_activities, y=median)) +
geom_point(color="#167ebb") +
stat_smooth) +
geom_point(data=df.random.sim, aes(x=n_activities, y=random_similarity), color="gray50") +
xlab("Number of activities considered") +
ylab("Median similarity") +
xlim(c(0,16)) + ylim(c(0, 0.6))
p <-
ggplot(df.validation, aes(x=n_activities, y=median)) +
geom_point(color="#167ebb") +
stat_smooth()) +
geom_point(data=df.random.sim, aes(x=n_activities, y=random_similarity), color="gray50") +
xlab("Number of activities considered") +
ylab("Median similarity") +
xlim(c(0,16)) + ylim(c(0, 0.6))
ggplot(df.validation, aes(x=n_activities, y=median)) +
geom_point(color="#167ebb") +
stat_smooth()) +
geom_point(data=df.random.sim, aes(x=n_activities, y=random_similarity), color="gray50") +
xlab("Number of activities considered") +
ylab("Median similarity") +
xlim(c(0,16)) + ylim(c(0, 0.6))
setwd("~/Dropbox/insight-data-science/project/strava_buddies/R/")
f.validation  <- "validation.csv"
f.random.sim  <- "random_similarities.csv"
df.validation <- read.csv(f.validation)
df.random.sim <- read.csv(f.random.sim, header=FALSE, col.names=c("trial", "random_similarity"))
df.random.sim$n_activities <- sample(1:15, size=500, replace=TRUE)
f.validation  <- "validation.csv"
df.validation <- read.csv(f.validation)
ggplot(df.validation, aes(x=n_activities, y=median)) +
geom_point(color="#167ebb") +
stat_smooth()) +
geom_point(data=df.random.sim, aes(x=n_activities, y=random_similarity), color="gray50") +
xlab("Number of activities considered") +
ylab("Median similarity") +
xlim(c(0,16)) + ylim(c(0, 0.6))
ggplot(df.validation, aes(x=n_activities, y=median)) +
geom_point(color="#167ebb") +
stat_smooth() +
geom_point(data=df.random.sim, aes(x=n_activities, y=random_similarity), color="gray50") +
xlab("Number of activities considered") +
ylab("Median similarity") +
xlim(c(0,16)) + ylim(c(0, 0.6))
ggplot(df.validation, aes(x=n_activities, y=median)) +
geom_point(color="#167ebb") +
stat_smooth(fill="blue", colour="darkblue", size=2) +
geom_point(data=df.random.sim, aes(x=n_activities, y=random_similarity), color="gray50") +
stat_smooth(fill="gray50", colour="gray40", size=2)
xlab("Number of activities considered") +
ylab("Median similarity") +
xlim(c(0,16)) + ylim(c(0, 0.6))
